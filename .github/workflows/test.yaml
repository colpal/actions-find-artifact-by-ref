---
'on':
  push:
    paths:
      - out.js
      - .github/workflows/test.yaml

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - id: single
        uses: ./
        with:
          ref: initial-workflow-dispatch
          artifact_name: Banana
          download: true

      - run: md5sum -c <<< "$EXPECTED Banana.zip"
        env:
          EXPECTED: 9ae11cf898d2956092d297ed9bf339ae

      - id: multiple
        uses: ./
        continue-on-error: true
        with:
          ref: initial-workflow-dispatch
          artifact_name: Apple

      - id: none
        uses: ./
        continue-on-error: true
        with:
          ref: initial-workflow-dispatch
          artifact_name: Cherry

      - if: "steps.single.outputs.artifact_id == 165488281 &&
             steps.multiple.outputs.error == 'multiple-artifacts' &&
             steps.none.outputs.error == 'no-artifacts'"
        run: exit
