---
'on':
  push:
    paths:
      - out.js
      - .github/workflows/test.yaml

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - id: single
        uses: ./
        with:
          ref: initial-workflow-dispatch
          artifact_name: Banana
          download: true

      - run: exit 1
        if: "'bd0e39476caf4065f42251d97e5a07232269fc2a335621a2f5f1bd5774f03cfe'
             !=
             hashFiles('Banana.zip')"

      - id: multiple
        uses: ./
        continue-on-error: true
        with:
          ref: initial-workflow-dispatch
          artifact_name: Apple

      - id: none
        uses: ./
        continue-on-error: true
        with:
          ref: initial-workflow-dispatch
          artifact_name: Cherry

      - if: "steps.single.outputs.artifact_id == 165488281 &&
             steps.multiple.outputs.error == 'multiple-artifacts' &&
             steps.none.outputs.error == 'no-artifacts'"
        run: exit
